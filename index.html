<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì´ì§€í¬ | ê°œë°œ ë¸”ë¡œê·¸</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg: #08080e; --bg2: #0e0e18; --bg3: #13131f;
      --surface: #191926; --surface2: #222235;
      --border: rgba(255,255,255,0.06);
      --accent: #7165f0; --accent2: #a89eff; --accent3: #5eead4;
      --text: #eeeef5; --text2: #8888a8; --text3: #44445a;
      --nav-h: 64px; --radius: 16px;
    }
    html { scroll-behavior: smooth; }
    body { font-family: 'Pretendard', -apple-system, sans-serif; background: var(--bg); color: var(--text); overflow-x: hidden; line-height: 1.7; }
    ::selection { background: rgba(113,101,240,0.3); }
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: var(--surface2); border-radius: 99px; }

    /* NAV */
    nav {
      position: fixed; top: 0; left: 0; right: 0; height: var(--nav-h);
      background: rgba(8,8,14,0.85); backdrop-filter: blur(24px);
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 5%; z-index: 1000; transition: background 0.3s;
    }
    .logo {
      font-family: 'JetBrains Mono', monospace; font-size: 1rem; font-weight: 600;
      color: var(--text); text-decoration: none;
      display: flex; align-items: center; gap: 10px;
    }
    .logo-icon {
      width: 34px; height: 34px; border-radius: 10px;
      background: linear-gradient(135deg, var(--accent), #5b8af0);
      display: flex; align-items: center; justify-content: center;
      font-size: 1rem; box-shadow: 0 0 20px rgba(113,101,240,0.4);
    }
    .nav-links { display: flex; gap: 1.75rem; list-style: none; }
    .nav-links a {
      color: var(--text2); text-decoration: none; font-size: 0.85rem; font-weight: 500;
      transition: color 0.2s;
    }
    .nav-links a:hover, .nav-links a.active { color: var(--text); }
    .nav-toggle { display: none; cursor: pointer; background: none; border: none; color: var(--text); font-size: 1.3rem; }

    /* HERO */
    .hero {
      min-height: 40vh;
      display: flex; align-items: center; justify-content: center;
      padding: calc(var(--nav-h) + 3rem) 5% 3rem;
      position: relative; overflow: hidden;
      border-bottom: 1px solid var(--border);
    }
    .hero-bg {
      position: absolute; inset: 0;
      background: radial-gradient(ellipse 60% 50% at 50% 40%, rgba(113,101,240,0.12) 0%, transparent 60%);
    }
    .hero-dots {
      position: absolute; inset: 0;
      background-image: radial-gradient(rgba(255,255,255,0.04) 1px, transparent 1px);
      background-size: 32px 32px;
      mask-image: radial-gradient(ellipse at center, rgba(0,0,0,0.4) 0%, transparent 75%);
    }
    .hero-content { position: relative; text-align: center; max-width: 700px; }
    .hero-title {
      font-size: clamp(2rem, 4vw, 3rem);
      font-weight: 900; line-height: 1.2;
      letter-spacing: -0.03em;
      margin-bottom: 0.75rem;
      background: linear-gradient(135deg, #fff 20%, var(--accent2) 80%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    }
    .hero-desc { color: var(--text2); font-size: 1rem; line-height: 1.7; }

    /* MAIN */
    main { padding: 5rem 5%; max-width: 1100px; margin: 0 auto; }
    
    .section-header {
      display: flex; align-items: center; justify-content: space-between;
      flex-wrap: wrap; gap: 1rem; margin-bottom: 2.5rem;
    }
    .section-title {
      font-size: 1.5rem; font-weight: 800;
      display: flex; align-items: center; gap: 10px;
    }
    .post-count {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem; color: var(--text3);
      background: var(--surface); border: 1px solid var(--border);
      padding: 0.3rem 0.8rem; border-radius: 6px;
    }
    .search-box {
      position: relative; max-width: 280px; flex: 1;
    }
    .search-box input {
      width: 100%; background: var(--surface); border: 1px solid var(--border);
      border-radius: 10px; padding: 0.6rem 1rem 0.6rem 2.5rem;
      color: var(--text); font-size: 0.85rem; font-family: inherit;
      outline: none; transition: border-color 0.2s;
    }
    .search-box input:focus { border-color: var(--accent); }
    .search-box::before {
      content: 'ğŸ”'; position: absolute; left: 0.85rem; top: 50%;
      transform: translateY(-50%); font-size: 0.9rem;
    }

    /* POSTS GRID */
    .posts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem; }
    .post-card {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: var(--radius); overflow: hidden;
      transition: all 0.3s; cursor: pointer;
      display: flex; flex-direction: column;
    }
    .post-card:hover { border-color: rgba(113,101,240,0.35); transform: translateY(-4px); box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
    .post-header {
      padding: 1.5rem 1.5rem 1rem;
    }
    .post-meta {
      display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap;
      font-size: 0.75rem; color: var(--text3);
      margin-bottom: 0.75rem;
    }
    .post-category {
      font-family: 'JetBrains Mono', monospace;
      background: rgba(113,101,240,0.15); color: var(--accent2);
      border: 1px solid rgba(113,101,240,0.25);
      padding: 0.2rem 0.6rem; border-radius: 4px;
      font-size: 0.7rem; font-weight: 600;
      text-transform: uppercase; letter-spacing: 0.05em;
    }
    .post-date {
      font-family: 'JetBrains Mono', monospace;
    }
    .post-title {
      font-size: 1.15rem; font-weight: 700; line-height: 1.4;
      margin-bottom: 0.75rem; color: var(--text);
    }
    .post-excerpt {
      color: var(--text2); font-size: 0.88rem; line-height: 1.7;
      display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical;
      overflow: hidden; margin-bottom: 1rem;
    }
    .post-tags {
      display: flex; flex-wrap: wrap; gap: 0.4rem;
      padding: 0 1.5rem 1.5rem;
    }
    .post-tag {
      font-size: 0.7rem; background: var(--surface2);
      color: var(--text3); padding: 0.2rem 0.55rem;
      border-radius: 4px; border: 1px solid var(--border);
    }

    /* FILTER SECTION */
    .filter-section {
      margin-bottom: 2.5rem;
      padding: 1.25rem;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
    }
    .filter-label {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text2);
      margin-bottom: 0.75rem;
    }
    .tag-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    .filter-tag {
      font-size: 0.8rem;
      background: var(--surface2);
      color: var(--text2);
      border: 1px solid var(--border);
      padding: 0.4rem 0.9rem;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .filter-tag:hover {
      background: var(--bg3);
      border-color: rgba(113,101,240,0.3);
    }
    .filter-tag.active {
      background: rgba(113,101,240,0.2);
      color: var(--accent2);
      border-color: rgba(113,101,240,0.4);
    }
    .filter-tag .count {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      opacity: 0.7;
    }
    .filter-tag.all {
      background: rgba(94,234,212,0.15);
      color: var(--accent3);
      border-color: rgba(94,234,212,0.3);
    }
    .filter-tag.all.active {
      background: rgba(94,234,212,0.25);
      border-color: rgba(94,234,212,0.5);
    }

    .loading {
      text-align: center; padding: 4rem 2rem;
      color: var(--text3); font-size: 0.95rem;
    }
    .loading::before { content: 'â³ '; font-size: 1.5rem; display: block; margin-bottom: 0.5rem; }

    .empty {
      text-align: center; padding: 5rem 2rem;
      color: var(--text3);
    }
    .empty-icon { font-size: 3rem; margin-bottom: 1rem; opacity: 0.5; }
    .empty-text { font-size: 1rem; }

    /* FOOTER */
    footer {
      background: var(--bg); border-top: 1px solid var(--border);
      padding: 2rem 5%; text-align: center;
      color: var(--text3); font-size: 0.8rem;
    }

    /* RESPONSIVE */
    @media (max-width: 768px) {
      nav { padding: 0 1.25rem; }
      .nav-links { display: none; flex-direction: column; position: absolute; top: var(--nav-h); left: 0; right: 0; background: var(--bg2); border-bottom: 1px solid var(--border); padding: 1.5rem; gap: 1.25rem; }
      .nav-links.open { display: flex; }
      .nav-toggle { display: block; }
      main { padding: 3rem 1.25rem; }
      .section-header { flex-direction: column; align-items: flex-start; }
      .search-box { max-width: 100%; }
    }
  </style>
</head>
<body>

<!-- NAV -->
<nav id="navbar">
  <a class="logo" href="javascript:location.reload()">
    <div class="logo-icon">ğŸ€</div>
    Zoe.ios
  </a>
  <ul class="nav-links" id="navLinks">
    <li><a href="blog.html" class="active">ë¸”ë¡œê·¸</a></li>
    <li><a href="https://github.com/Zoe0929" target="_blank">GitHub</a></li>
    <li><a href="mailto:mam07065@naver.com">ì—°ë½í•˜ê¸°</a></li>
  </ul>
  <button class="nav-toggle" id="navToggle" aria-label="ë©”ë‰´">â˜°</button>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-bg"></div>
  <div class="hero-dots"></div>
  <div class="hero-content">
    <h1 class="hero-title">ğŸ“ ê°œë°œ ë¸”ë¡œê·¸</h1>
    <p class="hero-desc">iOS ê°œë°œ ê²½í—˜ê³¼ ê¸°ìˆ ì  ì¸ì‚¬ì´íŠ¸ë¥¼ ê¸°ë¡í•©ë‹ˆë‹¤.</p>
  </div>
</section>

<!-- MAIN -->
<main>
  <div class="section-header">
    <div class="section-title">
      ğŸ“š ì „ì²´ ê¸€
      <span class="post-count" id="postCount">0ê°œ</span>
    </div>
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="ê²€ìƒ‰..." />
    </div>
  </div>

  <!-- íƒœê·¸ í•„í„° -->
  <div class="filter-section" id="filterSection" style="display:none;">
    <div class="filter-label">ğŸ·ï¸ íƒœê·¸ í•„í„°</div>
    <div class="tag-filters" id="tagFilters">
      <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
    </div>
  </div>

  <div class="posts-grid" id="postsGrid">
    <div class="loading">ê¸€ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
  </div>
</main>

<!-- FOOTER -->
<footer>
  Â© 2025 ì´ì§€í¬ (Lee JiHee) Â· iOS Developer
</footer>

<script>
  // Mobile nav
  const toggle = document.getElementById('navToggle');
  const navEl = document.getElementById('navLinks');
  toggle.addEventListener('click', () => {
    navEl.classList.toggle('open');
    toggle.textContent = navEl.classList.contains('open') ? 'âœ•' : 'â˜°';
  });

  // Navbar scroll
  window.addEventListener('scroll', () => {
    document.getElementById('navbar').style.background =
      window.scrollY > 30 ? 'rgba(8,8,14,0.97)' : 'rgba(8,8,14,0.85)';
  });

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // BLOG LOGIC
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  // âš ï¸ ì—¬ê¸°ì— ë³¸ì¸ì˜ GitHub ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”
  const GITHUB_USER = 'Zoe0929';  // GitHub ì‚¬ìš©ìëª…
  const GITHUB_REPO = 'blog';     // ë¸”ë¡œê·¸ ë ˆí¬ì§€í† ë¦¬ëª…
  const POSTS_FOLDER = 'posts';   // md íŒŒì¼ì´ ë“¤ì–´ìˆëŠ” í´ë”ëª…

  let allPosts = [];
  let currentFilter = 'all';

  async function fetchPosts() {
    try {
      // GitHub APIë¡œ posts í´ë” ë‚´ íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
      const response = await fetch(
        `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/${POSTS_FOLDER}`
      );
      
      if (!response.ok) {
        throw new Error('ë ˆí¬ì§€í† ë¦¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. GitHub ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
      }

      const files = await response.json();
      
      // .md íŒŒì¼ë§Œ í•„í„°ë§
      const mdFiles = files.filter(f => f.name.endsWith('.md'));

      if (mdFiles.length === 0) {
        showEmpty();
        return;
      }

      // ê° íŒŒì¼ì˜ ë©”íƒ€ë°ì´í„° íŒŒì‹±
      allPosts = await Promise.all(mdFiles.map(async (file) => {
        const content = await fetch(file.download_url).then(r => r.text());
        return parsePost(file.name, content, file.download_url);
      }));

      // ë‚ ì§œ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
      allPosts.sort((a, b) => new Date(b.date) - new Date(a.date));

      renderTagFilters();
      renderPosts(allPosts);

    } catch (error) {
      document.getElementById('postsGrid').innerHTML = `
        <div class="empty">
          <div class="empty-icon">âš ï¸</div>
          <div class="empty-text">
            ${error.message}<br/><br/>
            <strong>ì„¤ì • ë°©ë²•:</strong><br/>
            1. GitHubì— '${GITHUB_REPO}' ë ˆí¬ì§€í† ë¦¬ ìƒì„±<br/>
            2. '${POSTS_FOLDER}/' í´ë” ìƒì„±<br/>
            3. .md íŒŒì¼ ì—…ë¡œë“œ (ì˜ˆ: 2025-02-19-first-post.md)
          </div>
        </div>
      `;
    }
  }

  function parsePost(filename, content, url) {
    // íŒŒì¼ëª…ì—ì„œ ë‚ ì§œ ì¶”ì¶œ (í˜•ì‹: YYYY-MM-DD-title.md)
    const dateMatch = filename.match(/^(\d{4}-\d{2}-\d{2})-(.+)\.md$/);
    const date = dateMatch ? dateMatch[1] : 'ë‚ ì§œ ì—†ìŒ';
    const slug = dateMatch ? dateMatch[2] : filename.replace('.md', '');

    // Front matter íŒŒì‹± (---ë¡œ ê°ì‹¸ì§„ YAML)
    const frontMatterRegex = /^---\s*\n([\s\S]*?)\n---\s*\n([\s\S]*)$/;
    const match = content.match(frontMatterRegex);

    let title = slug.replace(/-/g, ' ');
    let category = 'iOS';
    let tags = [];
    let excerpt = '';

    if (match) {
      const frontMatter = match[1];
      const body = match[2];

      // YAML íŒŒì‹±
      const titleMatch = frontMatter.match(/title:\s*["']?(.+?)["']?\s*$/m);
      const categoryMatch = frontMatter.match(/category:\s*["']?(.+?)["']?\s*$/m);
      const tagsMatch = frontMatter.match(/tags:\s*\[(.+?)\]/);

      if (titleMatch) title = titleMatch[1];
      if (categoryMatch) category = categoryMatch[1];
      if (tagsMatch) tags = tagsMatch[1].split(',').map(t => t.trim());

      // ë³¸ë¬¸ì—ì„œ ì²« ë¬¸ë‹¨ ì¶”ì¶œ
      excerpt = body.trim().split('\n\n')[0].replace(/[#*_`]/g, '').substring(0, 150);
    } else {
      // Front matter ì—†ìœ¼ë©´ ë³¸ë¬¸ ì²« ì¤„
      excerpt = content.trim().split('\n')[0].replace(/[#*_`]/g, '').substring(0, 150);
    }

    return { filename, date, slug, title, category, tags, excerpt, url };
  }

  function renderTagFilters() {
    // ëª¨ë“  íƒœê·¸ ìˆ˜ì§‘
    const tagCount = {};
    allPosts.forEach(post => {
      post.tags.forEach(tag => {
        tagCount[tag] = (tagCount[tag] || 0) + 1;
      });
    });

    const sortedTags = Object.entries(tagCount).sort((a, b) => b[1] - a[1]);

    if (sortedTags.length === 0) return;

    document.getElementById('filterSection').style.display = 'block';

    const filtersHTML = `
      <div class="filter-tag all active" onclick="filterByTag('all')">
        ì „ì²´ <span class="count">${allPosts.length}</span>
      </div>
      ${sortedTags.map(([tag, count]) => `
        <div class="filter-tag" onclick="filterByTag('${tag}')">
          #${tag} <span class="count">${count}</span>
        </div>
      `).join('')}
    `;

    document.getElementById('tagFilters').innerHTML = filtersHTML;
  }

  function filterByTag(tag) {
    currentFilter = tag;

    // í•„í„° ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
    document.querySelectorAll('.filter-tag').forEach(el => {
      el.classList.remove('active');
    });
    event.target.closest('.filter-tag').classList.add('active');

    // í¬ìŠ¤íŠ¸ í•„í„°ë§
    let filtered = allPosts;
    if (tag !== 'all') {
      filtered = allPosts.filter(post => post.tags.includes(tag));
    }

    renderPosts(filtered);

    // ê²€ìƒ‰ì°½ ì´ˆê¸°í™”
    document.getElementById('searchInput').value = '';
  }

  function renderPosts(posts) {
    const grid = document.getElementById('postsGrid');
    document.getElementById('postCount').textContent = `${posts.length}ê°œ`;

    if (posts.length === 0) {
      grid.innerHTML = `
        <div class="empty">
          <div class="empty-icon">ğŸ”</div>
          <div class="empty-text">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
        </div>
      `;
      return;
    }

    grid.innerHTML = posts.map(post => `
      <div class="post-card" onclick="location.href='post.html?file=${encodeURIComponent(post.filename)}'">
        <div class="post-header">
          <div class="post-meta">
            <span class="post-category">${post.category}</span>
            <span class="post-date">${post.date}</span>
          </div>
          <h2 class="post-title">${post.title}</h2>
          <p class="post-excerpt">${post.excerpt}...</p>
        </div>
        ${post.tags.length > 0 ? `
        <div class="post-tags">
          ${post.tags.map(tag => `<span class="post-tag">#${tag}</span>`).join('')}
        </div>
        ` : ''}
      </div>
    `).join('');
  }

  function showEmpty() {
    document.getElementById('postsGrid').innerHTML = `
      <div class="empty">
        <div class="empty-icon">ğŸ“</div>
        <div class="empty-text">ì•„ì§ ì‘ì„±ëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>
      </div>
    `;
  }

  // ê²€ìƒ‰
  document.getElementById('searchInput').addEventListener('input', (e) => {
    const query = e.target.value.toLowerCase();
    
    // í˜„ì¬ í•„í„°ëœ í¬ìŠ¤íŠ¸ì—ì„œ ê²€ìƒ‰
    let basePosts = allPosts;
    if (currentFilter !== 'all') {
      basePosts = allPosts.filter(post => post.tags.includes(currentFilter));
    }

    const filtered = basePosts.filter(post =>
      post.title.toLowerCase().includes(query) ||
      post.excerpt.toLowerCase().includes(query) ||
      post.tags.some(tag => tag.toLowerCase().includes(query))
    );
    
    renderPosts(filtered);
  });

  // ì´ˆê¸° ë¡œë“œ
  fetchPosts();
</script>
</body>
</html>
